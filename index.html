<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redwood Support Agent App</title>
    <link rel="stylesheet" href="index.css">
</head>

<body>
    <!-- Header -->
    <div class="header">
        <div class="header-left">
            <div class="menu-icon">â˜°</div>
            <img src="oracle-logo-white.png" class="oracle-logo">
        </div>
        <div class="header-right">
            <div class="avatar"></div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Opportunity Header -->
        <div class="opportunity-header">
            <div style="margin-bottom: 12px;">
                <a href="#" style="font-size: 14px;">My Team's Opportunities</a>
            </div>

            <div style="display: flex; width: 100%; justify-content: space-between; align-items: center;">
                <div class="opportunity-title">
                    <h1>Redline Hosting - Hybrid Generator</h1>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons">
                    <button class="btn">Details</button>
                </div>
            </div>

            <div class="opportunity-details">
                <span class="stage-badge">01 - Qualification</span>
                <span class="detail-item"><span class="detail-label">Status</span>Open</span>
                <span class="detail-item"><span class="detail-label">Win Probability</span>20</span>
                <span class="detail-item"><span class="detail-label">Close Date</span>3/31/26</span>
                <span class="detail-item"><span class="detail-label">Account</span>Redline Hosting</span>
                <span class="detail-item"><span class="detail-label">Owner</span>Sales Rep</span>
            </div>
            <div>
                <input style="width: 500px;"></inpuit>
            </div>
        </div>

        <!-- Action Buttons -->
        <!-- <div class="action-buttons">
            <button class="btn">ðŸ“„ Details</button>
        </div> -->

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Activities -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-title">Activities</div>
                </div>
                <div class="card-title-underline"></div>
                <div style="margin-bottom: 15px;">
                    <strong style="font-size: 14px;">Recent</strong>
                </div>
                <ul class="activity-list">
                    <li class="activity-item">
                        <div class="activity-content">
                            <div class="activity-title">Close Date Updated</div>
                            <div class="activity-meta">By Sales Rep<br>1/28/26 12:00 PM</div>
                        </div>
                    </li>
                    <li class="activity-item">
                        <div class="activity-content">
                            <div class="activity-title">Opportunity Updated</div>
                            <div class="activity-meta">By Sales Rep<br>1/28/26 10:30 AM</div>
                        </div>
                    </li>
                    <li class="activity-item">
                        <div class="activity-content">
                            <div class="activity-title">Opportunity Updated</div>
                            <div class="activity-meta">By Sales Rep<br>1/28/26 10:00 AM</div>
                        </div>
                    </li>
                </ul>
                <a href="#" class="view-all">View All Activities (10)</a>
            </div>

            <!-- Contacts -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-title">Contacts</div>
                </div>
                <div class="card-title-underline"></div>
                <div class="contact-item">
                    <div class="contact-avatar">BR</div>
                    <div class="contact-info">
                        <div class="contact-name">Bill Richardson</div>
                        <div class="contact-role">VP, IT</div>
                        <div class="contact-phone">+1 (512) 555-4542</div>
                        <div class="contact-email">bill.richardson@oracledem...</div>
                    </div>
                    <span class="primary-badge">Primary</span>
                </div>
                <div class="contact-item">
                    <div class="contact-avatar">JB</div>
                    <div class="contact-info">
                        <div class="contact-name">James Brown</div>
                        <div class="contact-role">IT Director</div>
                        <div class="contact-phone">+1 (512) 555-4544</div>
                        <div class="contact-email">james.brown@oracledemos.com</div>
                    </div>
                </div>
                <a href="#" class="view-all">View All Contacts (2)</a>
            </div>

            <!-- Products -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-title">Products</div>
                </div>
                <div class="card-title-underline"></div>
                <div class="product-info">
                    <div class="product-label">Opportunity Amount</div>
                    <div class="product-value">$ 250,000</div>
                </div>
                <div class="product-info">
                    <div class="product-value">550kW Hybrid Generator</div>
                </div>
                <div class="product-info">
                    <div class="product-value">10</div>
                </div>
                <div class="product-info">
                    <div class="product-value">$ 250,000</div>
                </div>
                <a href="#" class="view-all">View All Products (1)</a>
            </div>

            <!-- Quotes -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-title">Quotes</div>
                </div>
                <div class="card-title-underline"></div>
                <div class="no-quotes">
                    <div class="no-quotes-title">There are no quotes created for this opportunity yet.</div>
                    <div class="no-quotes-text">As quotes are created, you can view them here.</div>
                </div>
            </div>

            <!-- Team -->
            <div class="dashboard-card">
                <div class="card-header">
                    <div class="card-title">Team</div>
                </div>
                <div class="card-title-underline"></div>
                <div class="team-member">
                    <div class="team-avatar">SR</div>
                    <div class="team-info">
                        <div class="team-name">Sales Rep</div>
                        <div class="team-email">sales.rep@oracledemos.com</div>
                    </div>
                </div>
                <a href="#" class="view-all">View All Team Members (1)</a>
            </div>
        </div>
    </div>

    <button id="feedbackButton">Feedback</button>

    <div id="feedbackPopup" class="popup">
        <div class="popup-content">
            <span class="close">&times;</span>
            <h2>User Feedback</h2>
            <form id="feedbackForm">
                <label for="name">Name:</label><br>
                <input type="text" id="name" name="name" required disabled value="Sales Rep"><br>
                <label for="email">Email:</label><br>
                <input type="email" id="email" name="email" required disabled value="sales.rep@oracledemos.com"><br>
                <label for="feedback">Feedback:</label><br>
                <textarea id="feedback" name="feedback" required rows="10"></textarea><br>
                <input type="submit" value="Submit">
            </form>
        </div>
    </div>

    <script src="index.js"></script>
    <script type="module" src="agent.js"></script>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const popup = document.getElementById('feedbackPopup');
        const closeBtn = document.querySelector('.close');
        const form = document.getElementById('feedbackForm');

        function openPopup() {
            popup.style.display = 'block';
            // Force reflow
            popup.offsetHeight;
            popup.classList.add('show');
        }

        function closePopup() {
            popup.classList.remove('show');
            setTimeout(() => {
                popup.style.display = 'none';
            }, 300); // Wait for transition (~300ms)
        }

        document.getElementById('feedbackButton').onclick = openPopup;
        closeBtn.onclick = closePopup;

        window.onclick = function (event) {
            if (event.target == popup) {
                closePopup();
            }
        }

        form.onsubmit = async function (e) {
            e.preventDefault();
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const feedbackText = document.getElementById('feedback').value;

            console.log('Feedback submitted:', { name, email, feedback: feedbackText });

            // Show a simple confirmation message in the popup, then close
            const content = popup.querySelector('.popup-content');
            const originalHTML = content.innerHTML;
            content.innerHTML = '<div style="padding:20px;text-align:center;"><h2>Feedback Submitted</h2></div>';
            setTimeout(() => {
                closePopup();
                content.innerHTML = originalHTML;
            }, 1400);

            form.reset();

            let agentResult;

            try {
                if (window.callGeminiAgent) {
                    agentResult = await window.callGeminiAgent({ name, email, feedback: feedbackText });
                }
            } catch (err) {
                console.error(err);
            }

            console.log('Agent result:', agentResult);
        }
    });
    </script>
</body>

</html>
